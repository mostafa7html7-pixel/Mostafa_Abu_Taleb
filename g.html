<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="x.css">
  <title>مسار التقوى</title>
      <link rel="icon" type="image/png" href="favicon_io/android-chrome-512x512.png" />

</head>

<body>
        <div class="f">
                <h1 class="v">"رَبِّ اشْرَحْ لِي صَدْرِي * وَيَسِّرْ لِي أَمْرِي * وَاحْلُلْ عُقْدَةً مِّن لِّسَانِي *
                        يَفْقَهُوا قَوْلِي" (سورة طه: 25-28).</h1>
        </div>
        <a href="files/Screenshot 2025-11-15 114720.png"><img src="files/Screenshot 2025-11-15 114720.png"
                        alt="files/Screenshot 2025-11-15 114720.png" class="h"></a>
        <div class="gallery">



                <a href="files/Screenshot 2025-11-15 111126.png"><img src="files/Screenshot 2025-11-15 111126.png"
                                alt="سبحان الله" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111145.png"><img src="files/Screenshot 2025-11-15 111145.png"
                                alt="والحمد لله" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111231.png"><img src="files/Screenshot 2025-11-15 111231.png"
                                alt="ولا اله الا الله" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111302.png"><img src="files/Screenshot 2025-11-15 111302.png"
                                alt="والله أكبر" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111347.png"><img src="files/Screenshot 2025-11-15 111347.png"
                                alt="سبحان الله" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111421.png"><img src="files/Screenshot 2025-11-15 111421.png"
                                alt="والحمد لله" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111500.png"><img src="files/Screenshot 2025-11-15 111500.png"
                                alt="و" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111520.png"><img src="files/Screenshot 2025-11-15 111520.png"
                                alt="" class="q"></a>
                <a href="files/Screenshot 2025-11-15 111913.png"><img src="files/Screenshot 2025-11-15 111913.png"
                                alt="" class="q"></a>
                <a href="files/Screenshot 2025-11-15 113104.png"><img src="files/Screenshot 2025-11-15 113104.png"
                                alt="" class="q"></a>
                <a href="files/Screenshot 2025-11-15 105438.png"><img src="files/Screenshot 2025-11-15 105438.png"
                                alt="" class="q"></a>
                <a href="files/Screenshot 2025-11-16 204454.png"><img src="files/Screenshot 2025-11-16 204454.png"
                                alt="" class="q"></a>

        </div>

        <!-- __________________________________________________________________________________________________________________________________ -->

        <style>
                /* viewer (modal) styles */
                .viewer {
                        position: fixed;
                        inset: 0;
                        background: rgba(0, 0, 0, 0.75);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 9999;
                        padding: 1rem;
                }

                .viewer.hidden {
                        display: none;
                }

                .viewer-content {
                        background: #fff;
                        border-radius: 8px;
                        max-width: 95%;
                        max-height: 95%;
                        box-shadow: 0 8px 24px rgba(0, 0, 0, .5);
                        overflow: hidden;
                        display: flex;
                        flex-direction: column;
                        align-items: stretch;
                }

                .viewer-img {
                        max-width: 100%;
                        max-height: calc(80vh);
                        object-fit: contain;
                        background: #000;
                }

                .viewer-actions {
                        display: flex;
                        gap: .5rem;
                        padding: .5rem;
                        justify-content: space-between;
                        align-items: center;
                        background: #f5f5f5;
                }

                .viewer-actions a,
                .viewer-actions button {
                        padding: .5rem .75rem;
                        border-radius: 6px;
                        border: 1px solid #ccc;
                        background: #fff;
                        cursor: pointer;
                        text-decoration: none;
                        color: #111;
                }

                .viewer-close {
                        background: #ff5b5b;
                        color: #fff;
                        border: none;
                }
        </style>
        <!-- ...existing code... -->
        <!-- (الصور والروابط الموجودة سابقاً تبقى كما هي) -->
        ...existing code...

        <!-- Viewer modal (do not remove) -->
        <div id="imageViewer" class="viewer hidden" aria-hidden="true" role="dialog" aria-label="عرض الصورة">
                <div class="viewer-content">
                        <img id="viewerImg" class="viewer-img" src="" alt="معاينة الصورة">
                        <div class="viewer-actions">
                                <div>
                                        <a id="downloadLink" href="#" download>تحميل الصورة</a>
                                </div>
                                <div>
                                        <button id="openFullBtn">فتح في تبويب جديد</button>
                                        <button id="closeViewer" class="viewer-close" aria-label="إغلاق">إغلاق</button>
                                </div>
                        </div>
                </div>
        </div>


        <script>
                // يفتح النافذة عند الضغط على أي صورة ضمن روابط داخل الصفحة
                (function () {
                        const viewer = document.getElementById('imageViewer');
                        const viewerImg = document.getElementById('viewerImg');
                        const downloadLink = document.getElementById('downloadLink');
                        const closeBtn = document.getElementById('closeViewer');
                        const openFullBtn = document.getElementById('openFullBtn');

                        // جميع الروابط التي تحتوي على الصور (تحمي من التنقل الافتراضي)
                        document.querySelectorAll('a > img.q').forEach(img => {
                                const anchor = img.parentElement;
                                anchor.addEventListener('click', function (e) {
                                        e.preventDefault();
                                        const href = anchor.getAttribute('href') || img.getAttribute('src');
                                        viewerImg.src = href;

                                        // زر التحميل الآن يجلب الصورة كـ blob ثم يخلق عملية تحميل على الجهاز
                                        downloadLink.onclick = async function (ev) {
                                                ev.preventDefault();
                                                try {
                                                        // fetch يعمل عندما تكون الملفات متاحة عبر خادم (محلي أو بعيد)
                                                        const res = await fetch(href, { cache: "no-store" });
                                                        if (!res.ok) throw new Error('فشل جلب الملف');
                                                        const blob = await res.blob();
                                                        const tmpUrl = URL.createObjectURL(blob);
                                                        const filename = (href.split('/').pop() || 'image').replace(/\s+/g, '_').replace(/[,]+/g, '');
                                                        const a = document.createElement('a');
                                                        a.href = tmpUrl;
                                                        a.download = filename;
                                                        document.body.appendChild(a);
                                                        a.click();
                                                        a.remove();
                                                        // تحرير الذاكرة بعد قليل
                                                        setTimeout(() => URL.revokeObjectURL(tmpUrl), 1000);
                                                } catch (err) {
                                                        console.error(err);
                                                        // كحل احتياطي افتح الصورة في تبويب جديد
                                                        window.open(href, '_blank');
                                                }
                                        };

                                        // فتح في تبويب جديد
                                        openFullBtn.onclick = () => window.open(href, '_blank');

                                        viewer.classList.remove('hidden');
                                        viewer.setAttribute('aria-hidden', 'false');
                                        // تركيز لسهولة الوصول
                                        closeBtn.focus();
                                });
                        });

                        // إغلاق النافذة
                        function closeViewer() {
                                viewer.classList.add('hidden');
                                viewer.setAttribute('aria-hidden', 'true');
                                viewerImg.src = '';
                        }
                        closeBtn.addEventListener('click', closeViewer);

                        // إغلاق عند الضغط خارج المحتوى أو الضغط على Escape
                        viewer.addEventListener('click', function (e) {
                                if (e.target === viewer) closeViewer();
                        });
                        document.addEventListener('keydown', function (e) {
                                if (e.key === 'Escape') closeViewer();
                        });
                })();
        </script>

</body>

</html>